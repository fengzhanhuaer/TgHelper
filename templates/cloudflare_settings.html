{% extends "base.html" %}
{% block content %}
  <div class="top-actions" style="justify-content: flex-start; gap: 8px;">
    <a class="ghost" href="{{ url_for('home', token=token) }}">返回首页</a>
    <a class="ghost" href="{{ url_for('logout', token=token) }}">退出登录</a>
  </div>
  <h1>Cloudflare D1 设置</h1>
  <p>输入 API Token 后可自动创建固定名称数据库：TgHelper。</p>

  {% if message %}
    <div class="error">{{ message }}</div>
  {% endif %}

  <form method="post" action="{{ url_for('cloudflare_settings') }}">
    <input type="hidden" name="token" value="{{ token }}" />
    <div class="field">
      <label for="cf_api_token">API Token</label>
      <input id="cf_api_token" name="cf_api_token" value="{{ cf_api_token }}" />
    </div>
    <div class="field">
      <label>D1 数据库名称</label>
      <input value="TgHelper" readonly />
    </div>
    <div class="field">
      <label>D1 数据库 ID（自动创建后回填）</label>
      <input value="{{ cf_d1_database_id }}" readonly />
    </div>
    <div style="display:flex; gap:8px;">
      <button class="btn" type="submit" name="action" value="save">保存</button>
      <button class="ghost" type="submit" name="action" value="test">测试 API</button>
      <button class="ghost" type="submit" name="action" value="create">自动创建 TgHelper 数据库</button>
    </div>
  </form>
{% endblock %}
